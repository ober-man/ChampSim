# Bimodal vs PAg vs PAp branch predictor schemes

Бимодальная схема является одноуровневой и использует массив классических двухбитовых счетчиков с насыщением, позволяющих предсказывать взятие бранча.
PAp и PAg принадлежат к классу двухуровневых схем предсказателя переходов. На втором уровне они оперируют все теми же двухбитовыми счетчиками.
Различаются они лишь способом хранения историй: в PAp схеме на каждый бранч создается своя PHT (Parent History table), а в PAg схеме - 1 глобальная PHT.
Реализация PAg схемы находится в файле [pag.cc](https://github.com/ober-man/ChampSim/blob/hw1/branch/pag/pag.cc), а PAp - в файле [pap.cc](https://github.com/ober-man/ChampSim/blob/hw1/branch/pap/pap.cc).

Проведем сравнение этих схем с использованием метрики IPC (Instruction Per Cycle), характеризующей производительность процессора:

![image](https://github.com/ober-man/ChampSim/assets/71032009/46340e82-49c4-4a7f-a365-8e1e78f8256d)

С точки зрения IPC, схема PAg выигрывает у бимодального предиктора на всех рассмотренных тестах, причем на тестах 600.perlbench, 602.gcc, 625.x264, 644.nab и 648.exchange2 выигрыш действительно существенный.
PAp, в свою очередь, в среднем дает аналогичный более лучший результат, но допускает просадку производительности на некоторых тестах (623.xalancbmk, 657.xz).

Среднее геометрическое метрик:
$$GEOMEAN_{Bimodal} = 1.1746$$
$$GEOMEAN_{PAg} = 1.3949$$
$$GEOMEAN_{PAp} = 1.3956$$

Теперь проанализируем результаты, рассмотрев метрику MPKI (Mispredicts Per KiloInstructions), относящуюся именно к работе предсказателей перехода.
Заметим, что чем больше значение метрики, тем хуже работает схема.

![image](https://github.com/ober-man/ChampSim/assets/71032009/4cb5b456-85a3-4c11-9d62-5d7ed2aa0ae5)

Результаты показывают сильное превосходство двухуровневых схем на большей части тестов, не считая просадки PAp схемы на тех же 2 тестах.
Видимо, эти тесты содержат сложно предсказываемые комбинации бранчей.
К тому же, на некоторых тестах (603.bwaves, 605.mcf, 649.fotonik3d, 654.roms) получилось снизить количество неверно предсказанных бранчей практически до нуля сразу на всех 3 схемах.
Двухуровневые схемы работают лучше одноуровневых в силу того, что онии позволяют обрабатывать более сложные последовательности переходов, 
в которых результат зависит не только от своей истории, но и от истории переходов соседних бранчей.

Среднее геометрическое метрик:
$$GEOMEAN_{Bimodal} = 2.4863$$
$$GEOMEAN_{PAg} = 1.0985$$
$$GEOMEAN_{PAp} = 1.1089$$
